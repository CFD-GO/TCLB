<?xml version="1.0"?>
<CLBConfig version="2.0" output="output/" permissive="true">
<!-- 3D RTI Test Case
	Run with d3q27_pf_velocity model
    @TMitchell
 -->
    <Geometry nx="256" ny="64" nz="2">
	    <MRT><Box /></MRT>
        <WAdiabatic>
            <Box nx="1"/>
        </WAdiabatic>
        <EAdiabatic>
            <Box dx="-1"/>
        </EAdiabatic>
        <ConstantTemp name="constanttemp">
            <Box dy="-1"/>
            <Box ny="1"/>
        </ConstantTemp>
        <MovingWall_N name="movingWall">
            <Box dy="-1" />
        </MovingWall_N>
        <Wall mask="ALL">
        	<Box ny="2" />
        </Wall>
    </Geometry>
    <Model>
	    <Param name="Density_h"   value="1"/>
        <Param name="Density_l"   value="0.33333333"/>
        <Param name="PhaseField"  value="1"/> 
        <Param name="PhaseField" value="0" zone="movingWall"/>
        <Param name="Radius" value="32"/>
        <Param name="CenterX" value="65"/>
        <Param name="CenterY" value="0"/>
        <Param name="CenterZ" value="0"/>
        <Param name="VelocityX" value="0.001"/>
        <Param name="shearFlow" value="1"/>
        <Param name="HEIGHT" value="64"/>
        <Param name="VelocityX" value="0.001" zone="movingWall"/>
        <Param name="IntWidth"    value="5"/> 
        <Param name="M"           value="0.02"/> 
        <Param name="sigma"       value="5e-3" />
        <Param name="Viscosity_l" value="0.1"/> 
		<Param name="Viscosity_h" value="0.1"/>
        <Param name="radAngle" value="45d"/>

        <Param name="k_h" value="0.2"/>
        <Param name="k_l" value="0.2"/>
        <Param name="cp_h" value="1"/>
        <Param name="cp_l" value="1"/>
        <Param name="ts_X" value="181"/>
        <Param name="ts_Y" value="21"/>
        <Param name="ts_dia" value="8"/>
        <Param name="ts_ws" value="6"/>
        <Param name="thermal_source" value="0.2"/>
        <Param name="sigma_T" value="2e-4"/>
        <Param name="T_ref" value="0"/>
        <Param name="T_init" value="0"/>
        <Param name="stabiliser" value="1e-1"/>
    </Model>
<VTK/>
<Init/>
<Container>
    <VTK Iterations="1000"/>
    <Stop TempChangeBelow="1e-6" Times="4" Iterations="100"/>
    <RunAction name="TempToSteadyState"  Iterations="100000"/>
</Container>
<VTK />
<Failcheck nx="10"	Iterations="5"/>
<Solve 		Iterations="1000">
    <VTK 	Iterations="50" />
</Solve>
</CLBConfig>
