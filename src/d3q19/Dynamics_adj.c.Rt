<?R
	source("conf.R");
	c_header();
?>

CudaDeviceFunction real_t getRhoB(){
        return <?R C(sum(PV(DensityAD$name[DensityAD$group == "f"]))) ?>;
}

CudaDeviceFunction real_t getWB(){
        return wb;
}

CudaDeviceFunction real_t getTB(){
        return <?R C(sum(PV(DensityAD$name[DensityAD$group == "T"]))) ?>;
}

CudaDeviceFunction vector_t getUB(){
        vector_t u;
	<?R C(PV(c("u.x","u.y", "u.z")) == PV(DensityAD$name[DensityAD$group == "f"]) %% U) ?>;
	return u;
}

CudaDeviceFunction void RunAdj(){
	if (NodeType & NODE_DesignSpace ) {
		wb /= 1000;
//		if (wb > 0.00001)  wb =  0.01;
//		if (wb < -0.00001) wb = -0.01;
		w += wb;
		if (w > 1.0) w=1.0;
		if (w < 0.01) w=0.01;
	}
	wb=0;
}
